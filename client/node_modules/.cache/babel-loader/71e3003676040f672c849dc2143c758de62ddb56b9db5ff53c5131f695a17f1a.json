{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\karen\\\\OneDrive\\\\Escritorio\\\\Correa3\\\\Correa\\\\client\\\\src\\\\pages\\\\Bartender.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { initBarSocket } from '../services/BarSocket';\nimport jsPDF from 'jspdf';\nimport './bartender.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LEDGER_KEY = 'alcohol_sales_ledger_v1';\nfunction loadLedger() {\n  try {\n    const raw = localStorage.getItem(LEDGER_KEY);\n    if (!raw) {\n      return {\n        processedOrderIds: {},\n        totals: {\n          simples: 0,\n          dobles: 0,\n          triples: 0,\n          botellas: 0,\n          amount: 0\n        }\n      };\n    }\n    const parsed = JSON.parse(raw);\n    return {\n      processedOrderIds: parsed.processedOrderIds || {},\n      totals: parsed.totals || {\n        simples: 0,\n        dobles: 0,\n        triples: 0,\n        botellas: 0,\n        amount: 0\n      }\n    };\n  } catch {\n    return {\n      processedOrderIds: {},\n      totals: {\n        simples: 0,\n        dobles: 0,\n        triples: 0,\n        botellas: 0,\n        amount: 0\n      }\n    };\n  }\n}\nfunction saveLedger(ledger) {\n  localStorage.setItem(LEDGER_KEY, JSON.stringify(ledger));\n}\nconst Bartender = () => {\n  _s();\n  const [orders, setOrders] = useState([]);\n  const [ledger, setLedger] = useState(loadLedger());\n  const [showStats, setShowStats] = useState(false);\n\n  // 🔒 Cargar SOLO pedidos del bar y purgar localStorage\n  useEffect(() => {\n    const saved = localStorage.getItem('alcohol_orders');\n    if (saved) {\n      try {\n        const parsed = JSON.parse(saved).filter(o => ((o === null || o === void 0 ? void 0 : o.source) || 'bar') === 'bar');\n        localStorage.setItem('alcohol_orders', JSON.stringify(parsed));\n        setOrders(parsed);\n        foldOrdersIntoLedger(parsed);\n      } catch {}\n    }\n  }, []);\n\n  // 🔗 WS BAR + dedup por id y por “firma”\n  useEffect(() => {\n    const mergeUnique = incomingRaw => {\n      const allow = new Set(['tragos', 'botellas', 'cocteles', 'alcohol', 'bebidas alcohólicas']);\n      const incoming = (incomingRaw || []).filter(o => ((o === null || o === void 0 ? void 0 : o.source) || 'bar') === 'bar').map(o => ({\n        ...o,\n        items: (o.items || []).filter(it => allow.has((it.category || '').toLowerCase()))\n      })).filter(o => (o.items || []).length > 0);\n      if (!incoming.length) return;\n      setOrders(prev => {\n        // firma = mesa + timestamp (seg) + items\n        const signature = o => {\n          var _o$table, _o$timestamp;\n          return JSON.stringify({\n            t: (_o$table = o.table) !== null && _o$table !== void 0 ? _o$table : o.mesa,\n            ts: (_o$timestamp = o.timestamp) === null || _o$timestamp === void 0 ? void 0 : _o$timestamp.slice(0, 19),\n            items: (o.items || []).map(it => ({\n              n: it.name,\n              s: it.size,\n              q: it.quantity,\n              c: (it.category || '').toLowerCase()\n            }))\n          });\n        };\n        const mapById = new Map(prev.map(o => [o.id, o]));\n        const sigSet = new Set(prev.map(o => signature(o)));\n        for (const o of incoming) {\n          if (mapById.has(o.id)) {\n            const prevO = mapById.get(o.id);\n            mapById.set(o.id, {\n              ...prevO,\n              ...o,\n              completed: prevO.completed || o.completed\n            });\n          } else if (!sigSet.has(signature(o))) {\n            mapById.set(o.id, {\n              ...o,\n              completed: o.completed || false\n            });\n          }\n        }\n        const unique = Array.from(mapById.values());\n        localStorage.setItem('alcohol_orders', JSON.stringify(unique));\n        return unique;\n      });\n      foldOrdersIntoLedger(incoming);\n    };\n    initBarSocket(mergeUnique);\n  }, []);\n\n  // Sync entre pestañas\n  useEffect(() => {\n    const onStorage = e => {\n      if (e.key === 'alcohol_orders' && typeof e.newValue === 'string') {\n        try {\n          const parsed = JSON.parse(e.newValue).filter(o => ((o === null || o === void 0 ? void 0 : o.source) || 'bar') === 'bar');\n          setOrders(parsed);\n          foldOrdersIntoLedger(parsed);\n        } catch {}\n      }\n    };\n    window.addEventListener('storage', onStorage);\n    return () => window.removeEventListener('storage', onStorage);\n  }, []);\n\n  // Ledger\n  const foldOrdersIntoLedger = ordersArr => {\n    if (!Array.isArray(ordersArr) || ordersArr.length === 0) return;\n    setLedger(prev => {\n      const next = {\n        processedOrderIds: {\n          ...prev.processedOrderIds\n        },\n        totals: {\n          ...prev.totals\n        }\n      };\n      let changed = false;\n      for (const order of ordersArr) {\n        var _ref, _order$items;\n        if (!(order !== null && order !== void 0 && order.id) || ((order === null || order === void 0 ? void 0 : order.source) || 'bar') !== 'bar' || next.processedOrderIds[order.id]) continue;\n        const items = (_ref = (_order$items = order.items) !== null && _order$items !== void 0 ? _order$items : order.pedidos) !== null && _ref !== void 0 ? _ref : [];\n        for (const it of items) {\n          const size = (it.size || 'simple').toLowerCase();\n          const category = (it.category || '').toLowerCase();\n          const price = Number(it.price) || 0;\n          if (category === 'botellas') next.totals.botellas += Number(it.quantity) || 1;else if (size === 'doble') next.totals.dobles += 1;else if (size === 'triple') next.totals.triples += 1;else next.totals.simples += 1;\n          next.totals.amount += price;\n          changed = true;\n        }\n        next.processedOrderIds[order.id] = true;\n      }\n      if (changed) saveLedger(next);\n      return changed ? next : prev;\n    });\n  };\n\n  // Stats en vivo\n  const statsLive = useMemo(() => {\n    let total = 0,\n      simples = 0,\n      dobles = 0,\n      triples = 0,\n      botellas = 0;\n    for (const order of orders) {\n      var _ref2, _order$items2;\n      const items = (_ref2 = (_order$items2 = order.items) !== null && _order$items2 !== void 0 ? _order$items2 : order.pedidos) !== null && _ref2 !== void 0 ? _ref2 : [];\n      for (const it of items) {\n        const size = (it.size || 'simple').toLowerCase();\n        const category = (it.category || '').toLowerCase();\n        const price = Number(it.price) || 0;\n        if (category === 'botellas') botellas += Number(it.quantity) || 1;else if (size === 'doble') dobles++;else if (size === 'triple') triples++;else simples++;\n        total += price;\n      }\n    }\n    return {\n      total,\n      simples,\n      dobles,\n      triples,\n      botellas\n    };\n  }, [orders]);\n  const statsLedger = ledger.totals;\n  const resetLedger = () => {\n    const empty = {\n      processedOrderIds: {},\n      totals: {\n        simples: 0,\n        dobles: 0,\n        triples: 0,\n        botellas: 0,\n        amount: 0\n      }\n    };\n    setLedger(empty);\n    saveLedger(empty);\n  };\n  const markAsCompleted = orderId => {\n    setOrders(prev => {\n      const updated = prev.map(o => o.id === orderId ? {\n        ...o,\n        completed: true\n      } : o);\n      localStorage.setItem('alcohol_orders', JSON.stringify(updated));\n      return updated;\n    });\n  };\n  const clearCompletedOrders = () => {\n    setOrders(prev => {\n      const updated = prev.filter(o => !o.completed);\n      localStorage.setItem('alcohol_orders', JSON.stringify(updated));\n      return updated;\n    });\n  };\n  const downloadPDF = () => {\n    const doc = new jsPDF();\n    doc.setFontSize(16);\n    doc.text('Historial de Ventas - Bar', 10, 10);\n    doc.setFontSize(12);\n    doc.text(`Simples: ${statsLedger.simples}`, 10, 20);\n    doc.text(`Dobles: ${statsLedger.dobles}`, 10, 30);\n    doc.text(`Triples: ${statsLedger.triples}`, 10, 40);\n    doc.text(`Botellas: ${statsLedger.botellas}`, 10, 50);\n    doc.text(`Total vendido: $${statsLedger.amount.toFixed(2)}`, 10, 60);\n    doc.save('historial_ventas_bar.pdf');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bartender-interface\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Pedidos del Bar\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pedidos-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"columna\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"Pedidos Pendientes (\", orders.filter(o => !o.completed).length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this), orders.filter(o => !o.completed).map((order, idx) => {\n          var _order$table, _order$time, _order$items3;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pedido-card pendiente\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pedido-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: [\"Mesa \", (_order$table = order.table) !== null && _order$table !== void 0 ? _order$table : order.mesa]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: (_order$time = order.time) !== null && _order$time !== void 0 ? _order$time : new Date(order.timestamp).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pedido-items\",\n              children: (_order$items3 = order.items) === null || _order$items3 === void 0 ? void 0 : _order$items3.map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [item.name, \" \", item.size ? `(${item.size})` : '', item.category === 'botellas' ? ` x${item.quantity || 1}` : '']\n              }, `${order.id}-item-${i}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-completar\",\n              onClick: () => markAsCompleted(order.id),\n              children: \"Marcar como Completado\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this)]\n          }, `${order.id}-pend-${idx}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"columna\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"Pedidos Completados (\", orders.filter(o => o.completed).length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this), orders.filter(o => o.completed).map((order, idx) => {\n          var _order$table2, _order$time2, _order$items4;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pedido-card completado\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pedido-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: [\"Mesa \", (_order$table2 = order.table) !== null && _order$table2 !== void 0 ? _order$table2 : order.mesa]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: (_order$time2 = order.time) !== null && _order$time2 !== void 0 ? _order$time2 : new Date(order.timestamp).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pedido-items\",\n              children: (_order$items4 = order.items) === null || _order$items4 === void 0 ? void 0 : _order$items4.map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [item.name, \" \", item.size ? `(${item.size})` : '', item.category === 'botellas' ? ` x${item.quantity || 1}` : '']\n              }, `${order.id}-compitem-${i}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this)]\n          }, `${order.id}-comp-${idx}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this);\n        }), orders.some(o => o.completed) && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-eliminar\",\n          onClick: clearCompletedOrders,\n          children: \"\\uD83D\\uDDD1 Eliminar todas las completadas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowStats(s => !s),\n      children: showStats ? 'Ocultar resumen de ventas' : 'Mostrar resumen de ventas'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), showStats && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stats\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Resumen de Ventas (Hist\\xF3rico)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Simples: \", statsLedger.simples]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Dobles: \", statsLedger.dobles]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Triples: \", statsLedger.triples]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Botellas: \", statsLedger.botellas]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: [\"Total: $\", statsLedger.amount.toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 14\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        style: {\n          marginTop: 12\n        },\n        onClick: downloadPDF,\n        children: \"\\uD83D\\uDCC4 Descargar historial en PDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"details\", {\n        style: {\n          marginTop: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"summary\", {\n          children: \"Comparar con ventas abiertas (en vivo)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Simples (vivo): \", statsLive.simples]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Dobles (vivo): \", statsLive.dobles]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Triples (vivo): \", statsLive.triples]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Botellas (vivo): \", statsLive.botellas]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\"Total (vivo): $\", statsLive.total.toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 16\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"remove-button\",\n        style: {\n          marginTop: 12\n        },\n        onClick: resetLedger,\n        children: \"Reiniciar resumen hist\\xF3rico\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 193,\n    columnNumber: 5\n  }, this);\n};\n_s(Bartender, \"Sn1OyphKlUMDjppEPlNeoqH3OJw=\");\n_c = Bartender;\nexport default Bartender;\nvar _c;\n$RefreshReg$(_c, \"Bartender\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","initBarSocket","jsPDF","jsxDEV","_jsxDEV","LEDGER_KEY","loadLedger","raw","localStorage","getItem","processedOrderIds","totals","simples","dobles","triples","botellas","amount","parsed","JSON","parse","saveLedger","ledger","setItem","stringify","Bartender","_s","orders","setOrders","setLedger","showStats","setShowStats","saved","filter","o","source","foldOrdersIntoLedger","mergeUnique","incomingRaw","allow","Set","incoming","map","items","it","has","category","toLowerCase","length","prev","signature","_o$table","_o$timestamp","t","table","mesa","ts","timestamp","slice","n","name","s","size","q","quantity","c","mapById","Map","id","sigSet","prevO","get","set","completed","unique","Array","from","values","onStorage","e","key","newValue","window","addEventListener","removeEventListener","ordersArr","isArray","next","changed","order","_ref","_order$items","pedidos","price","Number","statsLive","total","_ref2","_order$items2","statsLedger","resetLedger","empty","markAsCompleted","orderId","updated","clearCompletedOrders","downloadPDF","doc","setFontSize","text","toFixed","save","className","children","fileName","_jsxFileName","lineNumber","columnNumber","idx","_order$table","_order$time","_order$items3","time","Date","toLocaleTimeString","item","i","onClick","_order$table2","_order$time2","_order$items4","some","style","marginTop","_c","$RefreshReg$"],"sources":["C:/Users/karen/OneDrive/Escritorio/Correa3/Correa/client/src/pages/Bartender.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { initBarSocket } from '../services/BarSocket';\r\nimport jsPDF from 'jspdf';\r\nimport './bartender.css';\r\n\r\nconst LEDGER_KEY = 'alcohol_sales_ledger_v1';\r\n\r\nfunction loadLedger() {\r\n  try {\r\n    const raw = localStorage.getItem(LEDGER_KEY);\r\n    if (!raw) {\r\n      return { processedOrderIds: {}, totals: { simples: 0, dobles: 0, triples: 0, botellas: 0, amount: 0 } };\r\n    }\r\n    const parsed = JSON.parse(raw);\r\n    return {\r\n      processedOrderIds: parsed.processedOrderIds || {},\r\n      totals: parsed.totals || { simples: 0, dobles: 0, triples: 0, botellas: 0, amount: 0 },\r\n    };\r\n  } catch {\r\n    return { processedOrderIds: {}, totals: { simples: 0, dobles: 0, triples: 0, botellas: 0, amount: 0 } };\r\n  }\r\n}\r\n\r\nfunction saveLedger(ledger) {\r\n  localStorage.setItem(LEDGER_KEY, JSON.stringify(ledger));\r\n}\r\n\r\nconst Bartender = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [ledger, setLedger] = useState(loadLedger());\r\n  const [showStats, setShowStats] = useState(false);\r\n\r\n  // 🔒 Cargar SOLO pedidos del bar y purgar localStorage\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem('alcohol_orders');\r\n    if (saved) {\r\n      try {\r\n        const parsed = JSON.parse(saved).filter(o => (o?.source || 'bar') === 'bar');\r\n        localStorage.setItem('alcohol_orders', JSON.stringify(parsed));\r\n        setOrders(parsed);\r\n        foldOrdersIntoLedger(parsed);\r\n      } catch {}\r\n    }\r\n  }, []);\r\n\r\n  // 🔗 WS BAR + dedup por id y por “firma”\r\n  useEffect(() => {\r\n    const mergeUnique = (incomingRaw) => {\r\n      const allow = new Set(['tragos','botellas','cocteles','alcohol','bebidas alcohólicas']);\r\n      const incoming = (incomingRaw || [])\r\n        .filter(o => (o?.source || 'bar') === 'bar')\r\n        .map(o => ({\r\n          ...o,\r\n          items: (o.items || []).filter(it => allow.has((it.category || '').toLowerCase()))\r\n        }))\r\n        .filter(o => (o.items || []).length > 0);\r\n\r\n      if (!incoming.length) return;\r\n\r\n      setOrders((prev) => {\r\n        // firma = mesa + timestamp (seg) + items\r\n        const signature = (o) => JSON.stringify({\r\n          t: o.table ?? o.mesa,\r\n          ts: o.timestamp?.slice(0,19),\r\n          items: (o.items||[]).map(it => ({n: it.name, s: it.size, q: it.quantity, c: (it.category||'').toLowerCase()}))\r\n        });\r\n\r\n        const mapById = new Map(prev.map(o => [o.id, o]));\r\n        const sigSet  = new Set(prev.map(o => signature(o)));\r\n\r\n        for (const o of incoming) {\r\n          if (mapById.has(o.id)) {\r\n            const prevO = mapById.get(o.id);\r\n            mapById.set(o.id, { ...prevO, ...o, completed: prevO.completed || o.completed });\r\n          } else if (!sigSet.has(signature(o))) {\r\n            mapById.set(o.id, { ...o, completed: o.completed || false });\r\n          }\r\n        }\r\n\r\n        const unique = Array.from(mapById.values());\r\n        localStorage.setItem('alcohol_orders', JSON.stringify(unique));\r\n        return unique;\r\n      });\r\n\r\n      foldOrdersIntoLedger(incoming);\r\n    };\r\n\r\n    initBarSocket(mergeUnique);\r\n  }, []);\r\n\r\n  // Sync entre pestañas\r\n  useEffect(() => {\r\n    const onStorage = (e) => {\r\n      if (e.key === 'alcohol_orders' && typeof e.newValue === 'string') {\r\n        try {\r\n          const parsed = JSON.parse(e.newValue).filter(o => (o?.source || 'bar') === 'bar');\r\n          setOrders(parsed);\r\n          foldOrdersIntoLedger(parsed);\r\n        } catch {}\r\n      }\r\n    };\r\n    window.addEventListener('storage', onStorage);\r\n    return () => window.removeEventListener('storage', onStorage);\r\n  }, []);\r\n\r\n  // Ledger\r\n  const foldOrdersIntoLedger = (ordersArr) => {\r\n    if (!Array.isArray(ordersArr) || ordersArr.length === 0) return;\r\n    setLedger((prev) => {\r\n      const next = {\r\n        processedOrderIds: { ...prev.processedOrderIds },\r\n        totals: { ...prev.totals },\r\n      };\r\n      let changed = false;\r\n      for (const order of ordersArr) {\r\n        if (!order?.id || (order?.source || 'bar') !== 'bar' || next.processedOrderIds[order.id]) continue;\r\n        const items = order.items ?? order.pedidos ?? [];\r\n        for (const it of items) {\r\n          const size = (it.size || 'simple').toLowerCase();\r\n          const category = (it.category || '').toLowerCase();\r\n          const price = Number(it.price) || 0;\r\n          if (category === 'botellas') next.totals.botellas += Number(it.quantity) || 1;\r\n          else if (size === 'doble')   next.totals.dobles += 1;\r\n          else if (size === 'triple')  next.totals.triples += 1;\r\n          else                         next.totals.simples += 1;\r\n          next.totals.amount += price;\r\n          changed = true;\r\n        }\r\n        next.processedOrderIds[order.id] = true;\r\n      }\r\n      if (changed) saveLedger(next);\r\n      return changed ? next : prev;\r\n    });\r\n  };\r\n\r\n  // Stats en vivo\r\n  const statsLive = useMemo(() => {\r\n    let total = 0, simples = 0, dobles = 0, triples = 0, botellas = 0;\r\n    for (const order of orders) {\r\n      const items = order.items ?? order.pedidos ?? [];\r\n      for (const it of items) {\r\n        const size = (it.size || 'simple').toLowerCase();\r\n        const category = (it.category || '').toLowerCase();\r\n        const price = Number(it.price) || 0;\r\n        if (category === 'botellas') botellas += Number(it.quantity) || 1;\r\n        else if (size === 'doble')   dobles++;\r\n        else if (size === 'triple')  triples++;\r\n        else                         simples++;\r\n        total += price;\r\n      }\r\n    }\r\n    return { total, simples, dobles, triples, botellas };\r\n  }, [orders]);\r\n\r\n  const statsLedger = ledger.totals;\r\n\r\n  const resetLedger = () => {\r\n    const empty = { processedOrderIds: {}, totals: { simples: 0, dobles: 0, triples: 0, botellas: 0, amount: 0 } };\r\n    setLedger(empty);\r\n    saveLedger(empty);\r\n  };\r\n\r\n  const markAsCompleted = (orderId) => {\r\n    setOrders(prev => {\r\n      const updated = prev.map(o => o.id === orderId ? { ...o, completed: true } : o);\r\n      localStorage.setItem('alcohol_orders', JSON.stringify(updated));\r\n      return updated;\r\n    });\r\n  };\r\n\r\n  const clearCompletedOrders = () => {\r\n    setOrders(prev => {\r\n      const updated = prev.filter(o => !o.completed);\r\n      localStorage.setItem('alcohol_orders', JSON.stringify(updated));\r\n      return updated;\r\n    });\r\n  };\r\n\r\n  const downloadPDF = () => {\r\n    const doc = new jsPDF();\r\n    doc.setFontSize(16);\r\n    doc.text('Historial de Ventas - Bar', 10, 10);\r\n    doc.setFontSize(12);\r\n    doc.text(`Simples: ${statsLedger.simples}`, 10, 20);\r\n    doc.text(`Dobles: ${statsLedger.dobles}`, 10, 30);\r\n    doc.text(`Triples: ${statsLedger.triples}`, 10, 40);\r\n    doc.text(`Botellas: ${statsLedger.botellas}`, 10, 50);\r\n    doc.text(`Total vendido: $${statsLedger.amount.toFixed(2)}`, 10, 60);\r\n    doc.save('historial_ventas_bar.pdf');\r\n  };\r\n\r\n  return (\r\n    <div className=\"bartender-interface\">\r\n      <h1>Pedidos del Bar</h1>\r\n\r\n      <div className=\"pedidos-grid\">\r\n        {/* Pendientes */}\r\n        <div className=\"columna\">\r\n          <h2>Pedidos Pendientes ({orders.filter(o => !o.completed).length})</h2>\r\n          {orders.filter(o => !o.completed).map((order, idx) => (\r\n            <div key={`${order.id}-pend-${idx}`} className=\"pedido-card pendiente\">\r\n              <div className=\"pedido-header\">\r\n                <strong>Mesa {order.table ?? order.mesa}</strong>\r\n                <span>{order.time ?? new Date(order.timestamp).toLocaleTimeString()}</span>\r\n              </div>\r\n              <div className=\"pedido-items\">\r\n                {order.items?.map((item, i) => (\r\n                  <div key={`${order.id}-item-${i}`}>\r\n                    {item.name} {item.size ? `(${item.size})` : ''}\r\n                    {item.category === 'botellas' ? ` x${item.quantity || 1}` : ''}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <button className=\"btn-completar\" onClick={() => markAsCompleted(order.id)}>\r\n                Marcar como Completado\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Completados */}\r\n        <div className=\"columna\">\r\n          <h2>Pedidos Completados ({orders.filter(o => o.completed).length})</h2>\r\n          {orders.filter(o => o.completed).map((order, idx) => (\r\n            <div key={`${order.id}-comp-${idx}`} className=\"pedido-card completado\">\r\n              <div className=\"pedido-header\">\r\n                <strong>Mesa {order.table ?? order.mesa}</strong>\r\n                <span>{order.time ?? new Date(order.timestamp).toLocaleTimeString()}</span>\r\n              </div>\r\n              <div className=\"pedido-items\">\r\n                {order.items?.map((item, i) => (\r\n                  <div key={`${order.id}-compitem-${i}`}>\r\n                    {item.name} {item.size ? `(${item.size})` : ''}\r\n                    {item.category === 'botellas' ? ` x${item.quantity || 1}` : ''}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ))}\r\n          {orders.some(o => o.completed) && (\r\n            <button className=\"btn-eliminar\" onClick={clearCompletedOrders}>\r\n              🗑 Eliminar todas las completadas\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <button onClick={() => setShowStats(s => !s)}>\r\n        {showStats ? 'Ocultar resumen de ventas' : 'Mostrar resumen de ventas'}\r\n      </button>\r\n\r\n      {showStats && (\r\n        <div className=\"stats\">\r\n          <h3>Resumen de Ventas (Histórico)</h3>\r\n          <p>Simples: {statsLedger.simples}</p>\r\n          <p>Dobles: {statsLedger.dobles}</p>\r\n          <p>Triples: {statsLedger.triples}</p>\r\n          <p>Botellas: {statsLedger.botellas}</p>\r\n          <p><strong>Total: ${statsLedger.amount.toFixed(2)}</strong></p>\r\n          <button style={{ marginTop: 12 }} onClick={downloadPDF}>📄 Descargar historial en PDF</button>\r\n          <details style={{ marginTop: 12 }}>\r\n            <summary>Comparar con ventas abiertas (en vivo)</summary>\r\n            <p>Simples (vivo): {statsLive.simples}</p>\r\n            <p>Dobles (vivo): {statsLive.dobles}</p>\r\n            <p>Triples (vivo): {statsLive.triples}</p>\r\n            <p>Botellas (vivo): {statsLive.botellas}</p>\r\n            <p><strong>Total (vivo): ${statsLive.total.toFixed(2)}</strong></p>\r\n          </details>\r\n          <button className=\"remove-button\" style={{ marginTop: 12 }} onClick={resetLedger}>\r\n            Reiniciar resumen histórico\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Bartender;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}